<!--
	TMOBO
	TCPU
	TCC-1-1
	TCC-1-2
	TCC-1-3
	TCC-1-4
	TPCHDIO
	TGPU1DIO
	THDD1
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Dashboard Template for Bootstrap</title>

    <link href="css/bootstrap.css" rel="stylesheet">
  </head>

  <body>
 
		<div id="chartContainer0" style="height: 300px; width:100%;">
		</div>
		<div id="chartContainer1" style="height: 300px; width:100%;">
		</div>
		<div id="chartContainer2" style="height: 300px; width:100%;">
		</div>
		<div id="chartContainer3" style="height: 300px; width:100%;">
		</div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.canvasjs.min.js"></script>
    <script type="text/javascript">
    window.onload = function()
    {
    	var dps = [];
    	for(var i = 0; i < 4; i++)
    		dps[i] = [];

		var charts = [];
		for(var i = 0; i < 4; i++)
		{
			charts.push(new CanvasJS.Chart("chartContainer" + i,{
				title :{
					text: "TCC-1-" + i + 1
				},			
				data: [{
					type: "spline",
					dataPoints: dps[i] 
				}]
			}));
		}
		
		var xVal = [];
		for(var i = 0; i < 4; i++)
			xVal[i] = 0;

		var dataLength = 200; // number of dataPoints visible at any point

		var updateChart = function(idx, temperature) {

			var yVal = parseInt(temperature);
			dps[idx].push({
				x: xVal[idx],
				y: yVal
			});
			xVal[idx]++;

			if (dps[idx].length > dataLength)
				dps[idx].shift();				
		
			
			charts[idx].render();		
		};

    	var client = new WebSocket("ws://localhost:8080/");
		client.onmessage = function (e) 
		{
			var sensorValues = JSON.parse(e.data);

			for(var i = 0; i < sensorValues.length; i++)
				if(sensorValues[i].id == "TCC-1-1")
					updateChart(0, sensorValues[i].value);

			for(var i = 0; i < sensorValues.length; i++)
				if(sensorValues[i].id == "TCC-1-2")
					updateChart(1, sensorValues[i].value);

			for(var i = 0; i < sensorValues.length; i++)
				if(sensorValues[i].id == "TCC-1-3")
					updateChart(2, sensorValues[i].value);

			for(var i = 0; i < sensorValues.length; i++)
				if(sensorValues[i].id == "TCC-1-4")
					updateChart(3, sensorValues[i].value);
			
			
			
        }
    }
		
 
    </script>
  </body>
</html>
